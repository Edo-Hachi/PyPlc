{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "dialog_base_schema.json",
  "title": "PyPlc Ver3 Dialog Base Schema",
  "description": "Base schema for PyPlc Ver3 dialog definition files",
  "type": "object",
  "required": ["title", "width", "height", "controls"],
  "properties": {
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Dialog window title"
    },
    "width": {
      "type": "integer",
      "minimum": 100,
      "maximum": 800,
      "description": "Dialog width in pixels"
    },
    "height": {
      "type": "integer",
      "minimum": 80,
      "maximum": 600,
      "description": "Dialog height in pixels"
    },
    "controls": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/control"
      },
      "description": "Array of UI controls in the dialog"
    }
  },
  "definitions": {
    "control": {
      "type": "object",
      "required": ["id", "type", "x", "y", "width", "height"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "description": "Unique control identifier"
        },
        "type": {
          "enum": ["button", "textinput", "label", "filelist"],
          "description": "Type of UI control"
        },
        "x": {
          "type": "integer",
          "minimum": 0,
          "description": "X position relative to dialog"
        },
        "y": {
          "type": "integer",
          "minimum": 0,
          "description": "Y position relative to dialog"
        },
        "width": {
          "type": "integer",
          "minimum": 1,
          "description": "Control width in pixels"
        },
        "height": {
          "type": "integer",
          "minimum": 1,
          "description": "Control height in pixels"
        },
        "visible": {
          "type": "boolean",
          "default": true,
          "description": "Whether control is visible by default"
        }
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {
                "const": "button"
              }
            }
          },
          "then": {
            "$ref": "controls/button_schema.json"
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "textinput"
              }
            }
          },
          "then": {
            "$ref": "controls/textinput_schema.json"
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "label"
              }
            }
          },
          "then": {
            "$ref": "controls/label_schema.json"
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "filelist"
              }
            }
          },
          "then": {
            "$ref": "controls/filelist_schema.json"
          }
        }
      ]
    }
  }
}